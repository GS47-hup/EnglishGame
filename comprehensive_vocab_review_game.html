<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Days 1-3 Comprehensive Vocabulary & Language Review Game</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            margin: 0;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            margin: 10px 0 0 0;
            font-size: 1.2em;
            opacity: 0.9;
        }

        .game-area {
            padding: 40px;
        }

        .exercise-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .exercise-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 20px;
            border-radius: 15px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .exercise-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .exercise-btn.active {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
        }

        .exercise-content {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: none;
        }

        .exercise-content.active {
            display: block;
        }

        .exercise-title {
            color: #667eea;
            font-size: 1.8em;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
        }

        .question-area {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .question {
            font-size: 1.3em;
            margin-bottom: 20px;
            color: #333;
            line-height: 1.5;
        }

        .options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .option {
            background: #e3f2fd;
            border: 2px solid #bbdefb;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            font-size: 1.1em;
            transition: all 0.3s ease;
        }

        .option:hover {
            background: #bbdefb;
            transform: scale(1.05);
        }

        .option.selected {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
        }

        .option.wrong {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }

        .matching-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 20px;
        }

        .matching-column {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
        }

        .matching-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border: 2px solid #ddd;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 1.1em;
        }

        .matching-item:hover {
            border-color: #667eea;
            transform: scale(1.03);
        }

        .matching-item.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .matching-item.matched {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
        }

        .sentence-builder {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .word-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            padding: 15px;
            background: #f0f8ff;
            border-radius: 8px;
        }

        .word-option {
            background: #2196f3;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1em;
            border: none;
            transition: all 0.3s ease;
        }

        .word-option:hover {
            background: #1976d2;
            transform: scale(1.1);
        }

        .word-option.used {
            background: #ccc;
            cursor: not-allowed;
        }

        .sentence-display {
            min-height: 60px;
            background: white;
            border: 2px dashed #667eea;
            padding: 15px;
            border-radius: 8px;
            font-size: 1.2em;
            line-height: 1.5;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }

        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .score-area {
            text-align: center;
            background: linear-gradient(45deg, #4caf50, #8bc34a);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .score {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .feedback {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 1.2em;
            font-weight: bold;
        }

        .feedback.correct {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }

        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }

        .audio-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 50%;
            font-size: 1.2em;
            cursor: pointer;
            margin-left: 10px;
            transition: all 0.3s ease;
        }

        .audio-btn:hover {
            background: #ff5252;
            transform: scale(1.1);
        }

        .day-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
        }

        .day-tab {
            background: #e3f2fd;
            border: none;
            padding: 15px 25px;
            margin: 0 5px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .day-tab.active {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
        }

        .progress-bar {
            background: #e0e0e0;
            height: 10px;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(45deg, #4caf50, #8bc34a);
            height: 100%;
            border-radius: 5px;
            transition: width 0.3s ease;
            width: 0%;
        }

        @media (max-width: 768px) {
            .matching-area {
                grid-template-columns: 1fr;
            }
            
            .exercise-selector {
                grid-template-columns: 1fr;
            }
            
            .options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåü Days 1-3 Vocabulary & Language Review üåü</h1>
            <p>Master all vocabulary and sentence patterns from your first three days!</p>
        </div>

        <div class="game-area">
            <div class="score-area">
                <div class="score">Score: <span id="score">0</span> / <span id="total">0</span></div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressBar"></div>
                </div>
            </div>

            <div class="day-tabs">
                <button class="day-tab active" onclick="filterByDay('all')">All Days</button>
                <button class="day-tab" onclick="filterByDay('day1')">Day 1</button>
                <button class="day-tab" onclick="filterByDay('day2')">Day 2</button>
                <button class="day-tab" onclick="filterByDay('day3')">Day 3</button>
            </div>

            <div class="exercise-selector">
                <button class="exercise-btn active" onclick="selectExercise('vocabulary')">
                    üìö Vocabulary Practice
                </button>
                <button class="exercise-btn" onclick="selectExercise('matching')">
                    üîó Word Matching
                </button>
                <button class="exercise-btn" onclick="selectExercise('sentences')">
                    üìù Sentence Building
                </button>
                <button class="exercise-btn" onclick="selectExercise('patterns')">
                    üó£Ô∏è Language Patterns
                </button>
                <button class="exercise-btn" onclick="selectExercise('integration')">
                    üîÑ Integration Practice
                </button>
                <button class="exercise-btn" onclick="selectExercise('listening')">
                    üëÇ Listening Practice
                </button>
            </div>

            <!-- Vocabulary Practice Exercise -->
            <div id="vocabulary" class="exercise-content active">
                <div class="exercise-title">üìö Vocabulary Practice</div>
                <div class="question-area">
                    <div class="question" id="vocabQuestion">What does this word mean?</div>
                    <div class="options" id="vocabOptions"></div>
                </div>
                <div class="controls">
                    <button class="btn" onclick="generateVocabQuestion()">New Question</button>
                    <button class="btn" onclick="checkVocabAnswer()">Check Answer</button>
                </div>
                <div id="vocabFeedback" class="feedback" style="display: none;"></div>
            </div>

            <!-- Word Matching Exercise -->
            <div id="matching" class="exercise-content">
                <div class="exercise-title">üîó Word Matching</div>
                <div class="matching-area">
                    <div class="matching-column">
                        <h3 style="text-align: center; color: #667eea;">Words</h3>
                        <div id="wordsColumn"></div>
                    </div>
                    <div class="matching-column">
                        <h3 style="text-align: center; color: #667eea;">Meanings</h3>
                        <div id="meaningsColumn"></div>
                    </div>
                </div>
                <div class="controls">
                    <button class="btn" onclick="generateMatchingExercise()">New Exercise</button>
                    <button class="btn" onclick="checkMatching()">Check Answers</button>
                </div>
                <div id="matchingFeedback" class="feedback" style="display: none;"></div>
            </div>

            <!-- Sentence Building Exercise -->
            <div id="sentences" class="exercise-content">
                <div class="exercise-title">üìù Sentence Building</div>
                <div class="sentence-builder">
                    <div class="question" id="sentencePrompt">Build this sentence:</div>
                    <div class="word-bank" id="wordBank"></div>
                    <div class="sentence-display" id="sentenceDisplay">Click words to build your sentence...</div>
                </div>
                <div class="controls">
                    <button class="btn" onclick="generateSentenceExercise()">New Sentence</button>
                    <button class="btn" onclick="clearSentence()">Clear</button>
                    <button class="btn" onclick="checkSentence()">Check</button>
                </div>
                <div id="sentenceFeedback" class="feedback" style="display: none;"></div>
            </div>

            <!-- Language Patterns Exercise -->
            <div id="patterns" class="exercise-content">
                <div class="exercise-title">üó£Ô∏è Language Patterns</div>
                <div class="question-area">
                    <div class="question" id="patternQuestion">Complete the language pattern:</div>
                    <div class="options" id="patternOptions"></div>
                </div>
                <div class="controls">
                    <button class="btn" onclick="generatePatternQuestion()">New Pattern</button>
                    <button class="btn" onclick="checkPatternAnswer()">Check Answer</button>
                </div>
                <div id="patternFeedback" class="feedback" style="display: none;"></div>
            </div>

            <!-- Integration Practice Exercise -->
            <div id="integration" class="exercise-content">
                <div class="exercise-title">üîÑ Integration Practice</div>
                <div class="question-area">
                    <div class="question" id="integrationQuestion">Combine vocabulary from different days:</div>
                    <div class="options" id="integrationOptions"></div>
                </div>
                <div class="controls">
                    <button class="btn" onclick="generateIntegrationQuestion()">New Question</button>
                    <button class="btn" onclick="checkIntegrationAnswer()">Check Answer</button>
                </div>
                <div id="integrationFeedback" class="feedback" style="display: none;"></div>
            </div>

            <!-- Listening Practice Exercise -->
            <div id="listening" class="exercise-content">
                <div class="exercise-title">üëÇ Listening Practice</div>
                <div class="question-area">
                    <div class="question" id="listeningQuestion">
                        Listen and choose the correct answer:
                        <button class="audio-btn" onclick="playAudio()">üîä</button>
                    </div>
                    <div class="options" id="listeningOptions"></div>
                </div>
                <div class="controls">
                    <button class="btn" onclick="generateListeningQuestion()">New Question</button>
                    <button class="btn" onclick="checkListeningAnswer()">Check Answer</button>
                </div>
                <div id="listeningFeedback" class="feedback" style="display: none;"></div>
            </div>
        </div>
    </div>

    <script>
        // Vocabulary data organized by days
        const vocabularyData = {
            day1: {
                family: ["father", "mother", "parents", "brother", "sister", "grandfather", "grandmother", "grandparents"],
                colors: ["red", "blue", "yellow", "green", "orange", "purple", "pink", "brown"],
                bodyParts: ["head", "hair", "eyes", "nose", "mouth", "ears", "hands", "arms", "legs", "feet"],
                greetings: ["hello", "hi", "goodbye", "bye"]
            },
            day2: {
                shapes: ["circle", "square", "triangle", "rectangle"],
                house: ["house", "door", "window", "roof", "room", "living room", "bedroom", "bathroom", "kitchen"],
                numbers: ["one", "two", "three", "four", "five"],
                schoolSupplies: ["pencil", "pen", "book", "eraser"],
                classroom: ["desk", "chair", "table", "board", "door", "window", "clock", "bookshelf"]
            },
            day3: {
                toys: ["ball", "doll", "car", "teddy bear", "balloon", "yo-yo", "train", "boat"],
                artSupplies: ["paint", "paper", "crayon", "marker", "chalk", "yarn", "tape", "brush"],
                instructions: ["listen", "point", "sit down", "stand up", "open", "close", "take", "give"]
            }
        };

        // Language patterns by day
        const languagePatterns = {
            day1: [
                { pattern: "Hello, how are you?", response: "I'm fine, thank you" },
                { pattern: "Who's this?", response: "This is my [family member]" },
                { pattern: "What color is this?", response: "It's [color]" },
                { pattern: "Touch your [body part]", response: "Show me your [body part]" },
                { pattern: "My father has [color] hair", response: "I have [color] eyes" }
            ],
            day2: [
                { pattern: "This is a [color] [shape]", response: "The [shape] is [color]" },
                { pattern: "What room is this?", response: "This is the [room]" },
                { pattern: "There are [number] [objects]", response: "I can see [number] [items]" },
                { pattern: "The [classroom object] is a [shape]", response: "This is my [supply]" },
                { pattern: "I use a [supply] to [action]", response: "This is a [school supply]" }
            ],
            day3: [
                { pattern: "This is a [color] [toy]", response: "The [toy] is [color]" },
                { pattern: "I have [number] [toys/supplies]", response: "There are [number] [objects]" },
                { pattern: "I use [supply] to [action]", response: "Please [instruction]" },
                { pattern: "Point to the [object]", response: "Touch the [item]" },
                { pattern: "The red ball is a circle", response: "I use blue crayon to color" }
            ]
        };

        // Integration sentences combining all days
        const integrationSentences = [
            "My father is in the living room",
            "The red circle",
            "Blue rectangle window", 
            "I have two eyes and one nose",
            "Hello! I have three books",
            "My brother has a blue car",
            "My sister plays with the doll",
            "I use paint in my bedroom",
            "The brush is in the kitchen",
            "I use my hands to hold the ball"
        ];

        // Game state
        let currentExercise = 'vocabulary';
        let currentDay = 'all';
        let score = 0;
        let totalQuestions = 0;
        let selectedAnswers = [];
        let matchingPairs = [];
        let currentSentence = [];
        let targetSentence = "";
        let currentAudio = null;

        // Initialize game
        function initGame() {
            updateScore();
            generateVocabQuestion();
            generateMatchingExercise();
            generateSentenceExercise();
            generatePatternQuestion();
            generateIntegrationQuestion();
            generateListeningQuestion();
        }

        // Exercise selection
        function selectExercise(exercise) {
            document.querySelectorAll('.exercise-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.exercise-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(exercise).classList.add('active');
            currentExercise = exercise;
        }

        // Day filtering
        function filterByDay(day) {
            document.querySelectorAll('.day-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            currentDay = day;
            
            // Regenerate current exercise with filtered vocabulary
            switch(currentExercise) {
                case 'vocabulary':
                    generateVocabQuestion();
                    break;
                case 'matching':
                    generateMatchingExercise();
                    break;
                case 'sentences':
                    generateSentenceExercise();
                    break;
                case 'patterns':
                    generatePatternQuestion();
                    break;
                case 'integration':
                    generateIntegrationQuestion();
                    break;
                case 'listening':
                    generateListeningQuestion();
                    break;
            }
        }

        // Get vocabulary based on current day filter
        function getFilteredVocabulary() {
            if (currentDay === 'all') {
                let allVocab = [];
                Object.values(vocabularyData).forEach(day => {
                    Object.values(day).forEach(category => {
                        allVocab = allVocab.concat(category);
                    });
                });
                return allVocab;
            } else {
                let dayVocab = [];
                Object.values(vocabularyData[currentDay]).forEach(category => {
                    dayVocab = dayVocab.concat(category);
                });
                return dayVocab;
            }
        }

        // Vocabulary Practice Functions
        function generateVocabQuestion() {
            const vocab = getFilteredVocabulary();
            const correctWord = vocab[Math.floor(Math.random() * vocab.length)];
            const wrongWords = vocab.filter(word => word !== correctWord)
                .sort(() => 0.5 - Math.random()).slice(0, 3);
            
            const options = [correctWord, ...wrongWords].sort(() => 0.5 - Math.random());
            
            document.getElementById('vocabQuestion').innerHTML = `
                <strong>${correctWord.toUpperCase()}</strong> - What category does this word belong to?
            `;
            
            const optionsContainer = document.getElementById('vocabOptions');
            optionsContainer.innerHTML = '';
            
            const categories = ['Family', 'Colors', 'Body Parts', 'Shapes', 'House/Home', 'School', 'Toys', 'Art Supplies'];
            const correctCategory = getWordCategory(correctWord);
            const wrongCategories = categories.filter(cat => cat !== correctCategory)
                .sort(() => 0.5 - Math.random()).slice(0, 3);
            
            const categoryOptions = [correctCategory, ...wrongCategories].sort(() => 0.5 - Math.random());
            
            categoryOptions.forEach(category => {
                const option = document.createElement('div');
                option.className = 'option';
                option.textContent = category;
                option.onclick = () => selectOption(option, category === correctCategory);
                optionsContainer.appendChild(option);
            });
            
            selectedAnswers = [];
            hideFeedback('vocabFeedback');
        }

        function getWordCategory(word) {
            for (const day of Object.values(vocabularyData)) {
                for (const [category, words] of Object.entries(day)) {
                    if (words.includes(word)) {
                        switch(category) {
                            case 'family': return 'Family';
                            case 'colors': return 'Colors';
                            case 'bodyParts': return 'Body Parts';
                            case 'shapes': return 'Shapes';
                            case 'house': return 'House/Home';
                            case 'schoolSupplies':
                            case 'classroom': return 'School';
                            case 'toys': return 'Toys';
                            case 'artSupplies': return 'Art Supplies';
                            default: return 'Other';
                        }
                    }
                }
            }
            return 'Other';
        }

        function selectOption(element, isCorrect) {
            document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
            selectedAnswers = [isCorrect];
        }

        function checkVocabAnswer() {
            if (selectedAnswers.length === 0) {
                showFeedback('vocabFeedback', 'Please select an answer!', false);
                return;
            }
            
            totalQuestions++;
            if (selectedAnswers[0]) {
                score++;
                showFeedback('vocabFeedback', 'üéâ Excellent! Correct answer!', true);
            } else {
                showFeedback('vocabFeedback', '‚ùå Not quite right. Try again!', false);
            }
            updateScore();
        }

        // Matching Exercise Functions
        function generateMatchingExercise() {
            const vocab = getFilteredVocabulary().slice(0, 6);
            const meanings = vocab.map(word => getWordMeaning(word));
            
            const shuffledMeanings = [...meanings].sort(() => 0.5 - Math.random());
            
            const wordsColumn = document.getElementById('wordsColumn');
            const meaningsColumn = document.getElementById('meaningsColumn');
            
            wordsColumn.innerHTML = '';
            meaningsColumn.innerHTML = '';
            
            vocab.forEach((word, index) => {
                const wordItem = document.createElement('div');
                wordItem.className = 'matching-item';
                wordItem.textContent = word;
                wordItem.onclick = () => selectMatchingItem(wordItem, 'word', index);
                wordsColumn.appendChild(wordItem);
            });
            
            shuffledMeanings.forEach((meaning, index) => {
                const meaningItem = document.createElement('div');
                meaningItem.className = 'matching-item';
                meaningItem.textContent = meaning;
                meaningItem.onclick = () => selectMatchingItem(meaningItem, 'meaning', index);
                meaningsColumn.appendChild(meaningItem);
            });
            
            matchingPairs = [];
            hideFeedback('matchingFeedback');
        }

        function getWordMeaning(word) {
            const meanings = {
                'father': 'üë® Male parent',
                'mother': 'üë© Female parent',
                'brother': 'üë¶ Male sibling',
                'sister': 'üëß Female sibling',
                'red': 'üî¥ Color of fire',
                'blue': 'üîµ Color of sky',
                'head': 'ü§Ø Top part of body',
                'hands': 'üëê Used to grab things',
                'house': 'üè† Place where you live',
                'door': 'üö™ Used to enter rooms',
                'ball': '‚öΩ Round toy to play with',
                'book': 'üìö Used for reading'
            };
            return meanings[word] || `üìù ${word.charAt(0).toUpperCase() + word.slice(1)}`;
        }

        let selectedMatchingItem = null;
        let selectedType = null;

        function selectMatchingItem(element, type, index) {
            if (selectedMatchingItem === null) {
                selectedMatchingItem = { element, type, index };
                element.classList.add('selected');
            } else {
                if (selectedType !== type) {
                    // Valid pair selection
                    matchingPairs.push({
                        word: type === 'word' ? index : selectedMatchingItem.index,
                        meaning: type === 'meaning' ? index : selectedMatchingItem.index
                    });
                    
                    element.classList.add('matched');
                    selectedMatchingItem.element.classList.add('matched');
                }
                
                selectedMatchingItem.element.classList.remove('selected');
                selectedMatchingItem = null;
                selectedType = null;
            }
        }

        function checkMatching() {
            totalQuestions++;
            
            if (matchingPairs.length >= 3) {
                score++;
                showFeedback('matchingFeedback', 'üéâ Great matching! Well done!', true);
            } else {
                showFeedback('matchingFeedback', '‚ùå Try to match more pairs correctly!', false);
            }
            updateScore();
        }

        // Sentence Building Functions
        function generateSentenceExercise() {
            const sentences = [
                "This is my father",
                "The ball is red",
                "I have two eyes",
                "Hello, how are you",
                "My sister has a doll",
                "The house has a door",
                "I use a pencil",
                "Please sit down",
                "There are three books",
                "The circle is blue"
            ];
            
            targetSentence = sentences[Math.floor(Math.random() * sentences.length)];
            const words = targetSentence.split(' ');
            const shuffledWords = [...words].sort(() => 0.5 - Math.random());
            
            // Add some extra distractor words
            const distractors = ['cat', 'big', 'under', 'five'];
            const finalWords = [...shuffledWords, ...distractors.slice(0, 2)].sort(() => 0.5 - Math.random());
            
            document.getElementById('sentencePrompt').textContent = `Build this sentence: "${targetSentence}"`;
            
            const wordBank = document.getElementById('wordBank');
            wordBank.innerHTML = '';
            
            finalWords.forEach(word => {
                const button = document.createElement('button');
                button.className = 'word-option';
                button.textContent = word;
                button.onclick = () => addWordToSentence(word, button);
                wordBank.appendChild(button);
            });
            
            currentSentence = [];
            document.getElementById('sentenceDisplay').textContent = 'Click words to build your sentence...';
            hideFeedback('sentenceFeedback');
        }

        function addWordToSentence(word, button) {
            if (!button.classList.contains('used')) {
                currentSentence.push(word);
                button.classList.add('used');
                updateSentenceDisplay();
            }
        }

        function updateSentenceDisplay() {
            const display = document.getElementById('sentenceDisplay');
            display.textContent = currentSentence.join(' ') || 'Click words to build your sentence...';
        }

        function clearSentence() {
            currentSentence = [];
            document.querySelectorAll('.word-option').forEach(btn => btn.classList.remove('used'));
            updateSentenceDisplay();
        }

        function checkSentence() {
            const userSentence = currentSentence.join(' ').toLowerCase();
            const target = targetSentence.toLowerCase();
            
            totalQuestions++;
            
            if (userSentence === target) {
                score++;
                showFeedback('sentenceFeedback', 'üéâ Perfect sentence! Well built!', true);
            } else {
                showFeedback('sentenceFeedback', `‚ùå Not quite right. Try: "${targetSentence}"`, false);
            }
            updateScore();
        }

        // Language Patterns Functions
        function generatePatternQuestion() {
            const patterns = currentDay === 'all' ? 
                [...languagePatterns.day1, ...languagePatterns.day2, ...languagePatterns.day3] :
                languagePatterns[currentDay] || languagePatterns.day1;
            
            const pattern = patterns[Math.floor(Math.random() * patterns.length)];
            const question = pattern.pattern;
            const correctResponse = pattern.response;
            
            // Generate wrong responses
            const allResponses = patterns.map(p => p.response).filter(r => r !== correctResponse);
            const wrongResponses = allResponses.sort(() => 0.5 - Math.random()).slice(0, 3);
            
            const options = [correctResponse, ...wrongResponses].sort(() => 0.5 - Math.random());
            
            document.getElementById('patternQuestion').innerHTML = `
                <strong>"${question}"</strong><br>
                What is the correct response?
            `;
            
            const optionsContainer = document.getElementById('patternOptions');
            optionsContainer.innerHTML = '';
            
            options.forEach(option => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = option;
                optionElement.onclick = () => selectOption(optionElement, option === correctResponse);
                optionsContainer.appendChild(optionElement);
            });
            
            selectedAnswers = [];
            hideFeedback('patternFeedback');
        }

        function checkPatternAnswer() {
            if (selectedAnswers.length === 0) {
                showFeedback('patternFeedback', 'Please select an answer!', false);
                return;
            }
            
            totalQuestions++;
            if (selectedAnswers[0]) {
                score++;
                showFeedback('patternFeedback', 'üéâ Excellent pattern knowledge!', true);
            } else {
                showFeedback('patternFeedback', '‚ùå Review the language patterns!', false);
            }
            updateScore();
        }

        // Integration Practice Functions
        function generateIntegrationQuestion() {
            const sentence = integrationSentences[Math.floor(Math.random() * integrationSentences.length)];
            const words = sentence.split(' ');
            const missingIndex = Math.floor(Math.random() * words.length);
            const missingWord = words[missingIndex];
            
            words[missingIndex] = '____';
            const questionSentence = words.join(' ');
            
            const vocab = getFilteredVocabulary();
            const wrongOptions = vocab.filter(w => w !== missingWord).sort(() => 0.5 - Math.random()).slice(0, 3);
            const options = [missingWord, ...wrongOptions].sort(() => 0.5 - Math.random());
            
            document.getElementById('integrationQuestion').innerHTML = `
                Complete this integrated sentence:<br>
                <strong>"${questionSentence}"</strong>
            `;
            
            const optionsContainer = document.getElementById('integrationOptions');
            optionsContainer.innerHTML = '';
            
            options.forEach(option => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = option;
                optionElement.onclick = () => selectOption(optionElement, option === missingWord);
                optionsContainer.appendChild(optionElement);
            });
            
            selectedAnswers = [];
            hideFeedback('integrationFeedback');
        }

        function checkIntegrationAnswer() {
            if (selectedAnswers.length === 0) {
                showFeedback('integrationFeedback', 'Please select an answer!', false);
                return;
            }
            
            totalQuestions++;
            if (selectedAnswers[0]) {
                score++;
                showFeedback('integrationFeedback', 'üéâ Great integration skills!', true);
            } else {
                showFeedback('integrationFeedback', '‚ùå Think about how words connect!', false);
            }
            updateScore();
        }

        // Listening Practice Functions
        function generateListeningQuestion() {
            const vocab = getFilteredVocabulary();
            const targetWord = vocab[Math.floor(Math.random() * vocab.length)];
            const wrongWords = vocab.filter(w => w !== targetWord).sort(() => 0.5 - Math.random()).slice(0, 3);
            const options = [targetWord, ...wrongWords].sort(() => 0.5 - Math.random());
            
            // Store the target word for audio playback
            window.currentListeningWord = targetWord;
            
            document.getElementById('listeningQuestion').innerHTML = `
                Listen and choose the correct word:
                <button class="audio-btn" onclick="playListeningAudio()">üîä</button>
            `;
            
            const optionsContainer = document.getElementById('listeningOptions');
            optionsContainer.innerHTML = '';
            
            options.forEach(option => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = option;
                optionElement.onclick = () => selectOption(optionElement, option === targetWord);
                optionsContainer.appendChild(optionElement);
            });
            
            selectedAnswers = [];
            hideFeedback('listeningFeedback');
        }

        function playListeningAudio() {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(window.currentListeningWord);
                utterance.rate = 0.8;
                utterance.pitch = 1;
                speechSynthesis.speak(utterance);
            } else {
                alert(`Listen: ${window.currentListeningWord}`);
            }
        }

        function checkListeningAnswer() {
            if (selectedAnswers.length === 0) {
                showFeedback('listeningFeedback', 'Please select an answer!', false);
                return;
            }
            
            totalQuestions++;
            if (selectedAnswers[0]) {
                score++;
                showFeedback('listeningFeedback', 'üéâ Excellent listening skills!', true);
            } else {
                showFeedback('listeningFeedback', '‚ùå Listen carefully and try again!', false);
            }
            updateScore();
        }

        // Utility Functions
        function showFeedback(elementId, message, isCorrect) {
            const feedback = document.getElementById(elementId);
            feedback.textContent = message;
            feedback.className = `feedback ${isCorrect ? 'correct' : 'incorrect'}`;
            feedback.style.display = 'block';
        }

        function hideFeedback(elementId) {
            document.getElementById(elementId).style.display = 'none';
        }

        function updateScore() {
            document.getElementById('score').textContent = score;
            document.getElementById('total').textContent = totalQuestions;
            
            const percentage = totalQuestions > 0 ? (score / totalQuestions) * 100 : 0;
            document.getElementById('progressBar').style.width = `${percentage}%`;
        }

        // Initialize the game when page loads
        window.onload = initGame;
    </script>
</body>
</html>